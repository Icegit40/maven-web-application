
node{
	def mavenHome = tool name: 'maven3.9.11'
	stage('1.clone'){
	  git "https://github.com/LandmakTechnology/maven-web-application"
	  /*sh "git clone https://github.com/LandmakTechnology/maven-web-application"*/
	  //sh "git clone https://github.com/LandmakTechnology/maven-web-application"
	}
	stage('2.mavenBuild'){
	   sh "${mavenHome}/bin/mvn clean package"
	}
	stage('3.codeQuality'){
       //sh "${mavenHome}/bin/mvn sonar:sonar"
	}
	stage('4.ploadArtifacts'){
	   sh "${mavenHome}/bin/mvn deploy"
	}
	stage('5.deploy2UAT'){
	  deploy adapters: [tomcat9(alternativeDeploymentContext: '', credentialsId: 'tomcatAccess', path: '', url: 'http://10.0.5.149:8080/')], contextPath: null, war: 'target/*war'	
	}
	stage('6.manualAPPROVAL'){
      sh " echo 'Please review & approve' "
      timeout(time:5, unit:'HOURS'){
      	input message: 'Application ready for deployment, Please review and approve'
      }

	}
	stage('7.deploy2Prod'){
	  deploy adapters: [tomcat9(alternativeDeploymentContext: '', credentialsId: 'tomcatAccess', path: '', url: 'http://10.0.5.149:8080/')], contextPath: null, war: 'target/*war'			
	}
	stage('8.notification'){
		echo 'deployment status'
		emailext body: '''Hi Team,

Great job.

Regards,
Landmark Technologies''', recipientProviders: [buildUser(), developers(), upstreamDevelopers(), contributor()], subject: 'build status', to: 'developers@gmail.com'
	}
}
